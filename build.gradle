plugins {
    id 'org.jetbrains.kotlin.jvm' version '1.6.10'
    id 'application'
    id 'com.github.johnrengelman.shadow' version '7.0.0'
    id 'com.google.cloud.tools.appengine' version '2.4.2'
}

group 'org.example'
version '1.1-SNAPSHOT'

application {
    mainClass = 'xyz.derekbriggs.MainPageKt'
}

repositories {
    mavenCentral()
    maven { url "https://jitpack.io" }
}

dependencies {
    implementation "org.jetbrains.kotlin:kotlin-stdlib"
    implementation 'com.google.appengine:appengine-api-1.0-sdk:2.0.4'

    implementation "com.google.guava:guava:31.1-jre"

    implementation "com.github.kwebio:kweb-core:0.11.1"
    implementation group: 'org.slf4j', name: 'slf4j-simple', version: '1.7.30'


    implementation "com.stripe:stripe-java:20.104.0"
}

import com.github.jengelman.gradle.plugins.shadow.transformers.ServiceFileTransformer
shadowJar {
    transform(ServiceFileTransformer) {
        path = 'META-INF/services'
        include 'org.eclipse.jetty.http.HttpFieldPreEncoder'
    }
}

appengine {
    stage {
        artifact = "build/libs/locutus-donation-site-1.1-SNAPSHOT-all.jar"
    }
    deploy {
        version = "GCLOUD_CONFIG"
        projectId = "GCLOUD_CONFIG"
    }
}